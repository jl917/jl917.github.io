"use strict";(self.webpackChunkrspress_doc_template=self.webpackChunkrspress_doc_template||[]).push([["5964"],{84865:function(e,n,t){t.r(n);var a=t(85893),s=t(50065);function r(e){let n=Object.assign({h1:"h1",a:"a",h3:"h3",ul:"ul",li:"li",p:"p",pre:"pre",code:"code",h2:"h2"},(0,s.ah)(),e.components);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(n.h1,{id:"update",children:[(0,a.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#update",children:"#"}),"Update"]}),"\n",(0,a.jsxs)(n.h3,{id:"update-\uD65C\uC131\uD654",children:[(0,a.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#update-\uD65C\uC131\uD654",children:"#"}),"Update \uD65C\uC131\uD654"]}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"ReactDOM.render"}),"\n",(0,a.jsx)(n.li,{children:"this.setState"}),"\n",(0,a.jsx)(n.li,{children:"this.forceUpdate"}),"\n",(0,a.jsx)(n.li,{children:"useState"}),"\n",(0,a.jsx)(n.li,{children:"useReducer"}),"\n"]}),"\n","\n",(0,a.jsxs)(n.h3,{id:"update-\uD504\uB85C\uC138\uC2A4",children:[(0,a.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#update-\uD504\uB85C\uC138\uC2A4",children:"#"}),"Update \uD504\uB85C\uC138\uC2A4"]}),"\n",(0,a.jsx)(n.p,{children:"this.update.enqueueSetState \uD1B5\uD574\uC11C Update\uB97C \uC0DD\uC131\uD558\uACE0 \uC2E4\uD589\uD55C\uB2E4."}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-sh",meta:"",children:"Update \uD65C\uC131\uD654\n    |\n    v\nshared.pending \uC0DD\uC131\n    |\n    v\n....\n    |\n    v\nupdateQueue \uCC98\uB9AC(completeWork)\n    |\n    v\n...\n"})}),"\n","\n",(0,a.jsxs)(n.h3,{id:"update\uAC1D\uCCB4",children:[(0,a.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#update\uAC1D\uCCB4",children:"#"}),"Update\uAC1D\uCCB4"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-js",meta:"",children:'// ClassComponent, HostRoot\nconst update = {\n  eventTime: "",\n  lane: "",\n  suspenseConfig: "",\n  tag: UpdateState, // CaptureUpdate, ForceUpdate, ReplaceState, UpdateState\n  payload: null, // ClassComponent this.setState args[0], HostRoot ReactDOM.render args[0]\n  callback: null, // ClassComponent this.setState args[1], HostRoot ReactDOM.render args[2]\n  next: null,\n};\n\n// FunctionComponent\nconst update = {\n  eventTime: "",\n  lane: "",\n  suspenseConfig: "",\n  action: "", // ????\n  eagerReducer: null, // useState\uB294 basicStateReducer\uC0AC\uC6A9.\n  eagerState: null, // \uB9AC\uB4C0\uC11C\uB97C \uD1B5\uD574 action\uC758 \uACB0\uACFC\uAC12\uC744 \uC5BB\uB294\uB2E4. basicStateReducer(baseState, action)\n  next: null,\n};\n\nfunction basicStateReducer(state, action) {\n  return typeof action === "function" ? action(state) : action;\n}\n'})}),"\n","\n",(0,a.jsxs)(n.h3,{id:"update-queue",children:[(0,a.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#update-queue",children:"#"}),"Update Queue"]}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"baseState: \uBA54\uBAA8\uB9AC\uC5D0 \uC784\uC2DC \uC800\uC7A5\uB418\uB294 \uAC12."}),"\n",(0,a.jsx)(n.li,{children:"memoizedState: \uD654\uBA74\uC5D0 \uB178\uCD9C\uB418\uB294 \uAC12"}),"\n",(0,a.jsx)(n.li,{children:"shared.pending: \uC5C5\uB370\uC774\uD2B8 \uD65C\uC131\uD654\uC2DC \uC784\uC2DC \uC800\uC7A5\uD558\uACE0 \uC6B0\uC120\uC21C\uC704\uC5D0 \uC801\uD569\uD55C Update\uB9CC firstBaseUpdate\uB4A4\uC5D0 \uCD94\uAC00."}),"\n"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-js",meta:"",children:"// ClassComponent\nconst Fiber = {\n  updateQueue: {\n    baseState: '',\n    firstBaseUpdate: Update,\n    lastBaseUpdate: Update,\n    shared: {\n      pending: Updates\n    }\n    effects: [] // update.callback \uC774 \uC874\uC7AC\uD558\uB294 \uACBD\uC6B0\uB9CC \uBC30\uC5F4\uC5D0 \uCD94\uAC00\n  }\n  memoizedState: stateValue\n}\n\n// FunctionComponent\nconst Fiber = {\n  memoizedState: { // Hook\n    memoizedState: stateValue,\n    baseState: '',\n    baseQueue: Update,\n    queue: Updates,\n    next, // Hook list\n  }\n}\n"})}),"\n","\n",(0,a.jsxs)(n.h2,{id:"update-\uC885\uB958\uBCC4",children:[(0,a.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#update-\uC885\uB958\uBCC4",children:"#"}),"update \uC885\uB958\uBCC4"]}),"\n",(0,a.jsxs)(n.h3,{id:"\uB2E8\uC77C-task",children:[(0,a.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#\uB2E8\uC77C-task",children:"#"}),"\uB2E8\uC77C Task"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-js",meta:"",children:"const App = () => {\n  const [count, setCount] = useState(0);\n  const onClick = () => setCount(count + 1);\n  return <div onClick={onClick}>{count}</div>;\n};\n"})}),"\n","\n",(0,a.jsxs)(n.h3,{id:"batchupdate",children:[(0,a.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#batchupdate",children:"#"}),"batchUpdate"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-js",meta:"",children:"const App = () => {\n  const [count, setCount] = useState(0);\n  const onClick1 = () => {\n    setCount(count + 1);\n    setCount(count + 1);\n    setCount(count + 1);\n  };\n  const onClick2 = () => {\n    setCount((baseState) => baseState + 1);\n    setCount((baseState) => baseState + 1);\n    setCount(count + 1);\n    setCount((baseState) => baseState + 1);\n  };\n  const onClick3 = () => {\n    setTimeout(() => {\n      // concurrent mode\uC77C \uACBD\uC6B0 \uBC30\uCE58\uB428, legacy mode\uC77C \uACBD\uC6B0 3\uBC88 \uB79C\uB529\uB428.\n      setCount(count + 1);\n      setCount(count + 1);\n      setCount(count + 1);\n    }, 0);\n  };\n  return (\n    <>\n      <h1>{count}</h1>\n      <div onClick={onClick1}>click1</div>\n      <div onClick={onClick2}>click2</div>\n      <div onClick={onClick3}>click3</div>\n    </>\n  );\n};\n"})}),"\n",(0,a.jsxs)(n.h3,{id:"high-priority-task",children:[(0,a.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#high-priority-task",children:"#"}),"high priority task"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-js",meta:"",children:"const arr = [];\narr.length = 6000;\narr.fill(0);\n\nconst App = () => {\n  const btnRef = useRef(null);\n  const [count, setCount] = useState(0);\n  const onClick = () => {\n    setCount((count) => count + 1);\n  };\n\n  useEffect(() => {\n    // \uB808\uAC70\uC2DC \uBAA8\uB4DC\uC5D0\uC11C\uB294 10, 11\uB85C \uD654\uBA74\uC5D0 \uB178\uCD9C\n    // \uB3D9\uC2DC\uC131 \uBAA8\uB4DC\uC5D0\uC11C\uB294 1, 11\uB85C \uD654\uBA74\uC5D0 \uB178\uCD9C(1\uCC28 \uC6B0\uC120\uC21C\uC704 \uB192\uC740\uAC70 \uC2E4\uD589, 2\uCC28 \uC21C\uCC28\uC801\uC73C\uB85C \uC2E4\uD589.)\n    // [10_2, x+1_1]\n    setTimeout(() => {\n      setCount(count + 10);\n    }, 2000);\n    setTimeout(() => {\n      btnRef.current.click();\n    }, 2000);\n  }, []);\n  return (\n    <>\n      <h1>{count}</h1>\n      <div\n        onClick={onClick}\n        ref={btnRef}\n      >\n        click1\n      </div>\n      {arr.map(() => (\n        <div>{count}</div>\n      ))}\n    </>\n  );\n};\n"})}),"\n",(0,a.jsxs)(n.h3,{id:"\uBCF5\uD569\uC801\uC778-\uACBD\uC6B0",children:[(0,a.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#\uBCF5\uD569\uC801\uC778-\uACBD\uC6B0",children:"#"}),"\uBCF5\uD569\uC801\uC778 \uACBD\uC6B0"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-js",meta:"",children:"// For example:\n//\n//   Given a base state of '', and the following queue of updates\n//\n//     A1 - B2 - C1 - D2\n//\n//   where the number indicates the priority, and the update is applied to the\n//   previous state by appending a letter, React will process these updates as\n//   two separate renders, one per distinct priority level:\n//\n//   First render, at priority 1:\n//     Base state: ''\n//     Updates: [A1, C1]\n//     Result state: 'AC'\n//\n//   Second render, at priority 2:\n//     Base state: 'A'            <-  The base state does not include C1,\n//                                    because B2 was skipped.\n//     Updates: [B2, C1, D2]      <-  C1 was rebased on top of B2\n//     Result state: 'ABCD'\n"})}),"\n","\n",(0,a.jsxs)(n.h3,{id:"\uCC38\uACE0",children:[(0,a.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#\uCC38\uACE0",children:"#"}),"\uCC38\uACE0"]}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.a,{href:"https://wonism.github.io/react-updater/",target:"_blank",rel:"noopener noreferrer",children:"https://wonism.github.io/react-updater/"})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.a,{href:"https://github.com/facebook/react/blob/main/packages/react-reconciler/src/ReactFiberClassUpdateQueue.old.js",target:"_blank",rel:"noopener noreferrer",children:"https://github.com/facebook/react/blob/main/packages/react-reconciler/src/ReactFiberClassUpdateQueue.old.js"})})]})}function d(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:n}=Object.assign({},(0,s.ah)(),e.components);return n?(0,a.jsx)(n,Object.assign({},e,{children:(0,a.jsx)(r,e)})):r(e)}n.default=d,d.__RSPRESS_PAGE_META={},d.__RSPRESS_PAGE_META["web%2Freact%2Fsources%2F04.md"]={toc:[{id:"update-\uD65C\uC131\uD654",text:"Update \uD65C\uC131\uD654",depth:3},{id:"update-\uD504\uB85C\uC138\uC2A4",text:"Update \uD504\uB85C\uC138\uC2A4",depth:3},{id:"update\uAC1D\uCCB4",text:"Update\uAC1D\uCCB4",depth:3},{id:"update-queue",text:"Update Queue",depth:3},{id:"update-\uC885\uB958\uBCC4",text:"update \uC885\uB958\uBCC4",depth:2},{id:"\uB2E8\uC77C-task",text:"\uB2E8\uC77C Task",depth:3},{id:"batchupdate",text:"batchUpdate",depth:3},{id:"high-priority-task",text:"high priority task",depth:3},{id:"\uBCF5\uD569\uC801\uC778-\uACBD\uC6B0",text:"\uBCF5\uD569\uC801\uC778 \uACBD\uC6B0",depth:3},{id:"\uCC38\uACE0",text:"\uCC38\uACE0",depth:3}],title:"Update",frontmatter:{}}}}]);